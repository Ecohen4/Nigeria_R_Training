<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Before getting started</title>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}
</style>



</head>

<body>
<p><link href="http://kevinburke.bitbucket.org/markdowncss/markdown.css" rel="stylesheet"></link></p>

<h1>Before getting started</h1>

<p>We recommend watch the following video before reading this document</p>

<ul>
<li><a href="http://www.youtube.com/watch?v=iffR3fWv4xw&amp;list=PLOU2XLYxmsIK9qQfztXeybpHvru-TrqAP">Video tutorial for R from Google Developer</a></li>
</ul>

<h1>Basic R</h1>

<h2>Getting started</h2>

<h3>Interface of Rstudio</h3>

<p><img src="https://lh3.googleusercontent.com/-fFe1VlFiVzA/TWvS0Cuvc3I/AAAAAAAALmk/RfFLB0h5dUM/s1600/rstudio-windows.png" alt="alt text"/></p>

<p>Items:</p>

<ul>
<li>Console</li>
<li>Script</li>
<li>Environment (will make sense later)</li>
<li>Help, Plots</li>
</ul>

<h3>Working directory</h3>

<p>R has a notion of a &ldquo;working directory&rdquo;. This is the directory that R can load files directly from.</p>

<pre><code class="r"># getting the current working directory
getwd()
</code></pre>

<pre><code>## [1] &quot;/Users/prabhaspokharel/Code/Nigeria_R_Training&quot;
</code></pre>

<pre><code>### setting &quot;my working directory&quot; as &quot;~/work/r/nigeria_r_training/&quot;
setwd(&quot;~/work/r/nigeria_r_training/&quot;)
</code></pre>

<h3>Getting help!</h3>

<p>Before we get any further, lets see how to get help. You can go to the &ldquo;Help&rdquo; tab in R-studio (right-hand-side bottom), or if you know the function to get help on, just use a question mark followed by the function name.</p>

<pre><code>?getwd
</code></pre>

<p>Use two question marks to search for functions if you don&#39;t know the name:</p>

<pre><code>??workingdirectory
</code></pre>

<h3>Reading data: read.csv</h3>

<p>.csv is the prefered data format in NMIS and in the data science space in general. Although there are functions in R to read other data formats, we recommend that one converts to csv prior to loading. Our motivations for using csv formats are similar to <a href="http://dataprotocols.org/simple-data-format/#why-csv">this article&#39;s</a>.</p>

<pre><code class="r">sample_data &lt;- read.csv(&quot;sample_health_facilities.csv&quot;, stringsAsFactors = FALSE)
</code></pre>

<p>This command calls read.csv on a filename, with an extra named argument, <code>stringsAsFactors</code>. The result is then assigned to sample_data. This command is equivalent to running <code>sample_data = read.csv(sample_health_facilities.csv, stringsAsFactors=FALSE)</code>, but the preferred syntax for assignment in R is <code>&lt;-</code> (ie, <code>&lt;</code> followed by <code>-</code>.)</p>

<h3>The sample dataset</h3>

<p>The dataset is a subset of our health dataset. We&#39;re providing you with a small piece of it, so that we can begin to understand things with small datasets, and eventually move on to the bigger datasets that we handle in the NMIS system. </p>

<p>Have a look at the <a href="https://github.com/SEL-Columbia/Nigeria_R_Training/blob/master/sample_health_facilities.csv">dataset here</a>, or open it in your favorite spreadsheet program (Excel, OpenOffice). We can also click on the name <code>sample_data</code> in the Environment panel on the top-left in R-studio, and we&#39;ll see the data rendered the way many other programs do.</p>

<p>Each row is a health clinic, either has a c-section or not, has a number of full-time nurses, has a number of lab techs, a management type, and so on. In our actual datasets, there are hundreds of columns like this.</p>

<h2>data.frame</h2>

<p>CSVs represent tabular data, which R is excellent at handling. Turns out that the data we have for NMIS is also tabular data, so we will be working with <code>data.frame</code>s in R most of the time.</p>

<p>A data.frame is made up of rows and columns. Lets get the &ldquo;dimensions&rdquo; of the data.frame:</p>

<pre><code class="r">dim(sample_data)
</code></pre>

<pre><code>## [1] 50 10
</code></pre>

<p>This shows that that <code>sample_data</code> has 50 rows and 10 columns. The functions <code>nrow</code> and <code>ncol</code> can give you these values individually:</p>

<pre><code class="r">nrow(sample_data)
</code></pre>

<pre><code>## [1] 50
</code></pre>

<pre><code class="r">ncol(sample_data)
</code></pre>

<pre><code>## [1] 10
</code></pre>

<h3>Displaying the data.frame</h3>

<p>After loading the data.frame, we often want to know what columns are in it (columns usually have names). To check the column names of a dataset, we can use the <code>colnames</code> function, or more simply, the <code>names</code> function:</p>

<pre><code class="r">names(sample_data)
</code></pre>

<pre><code>##  [1] &quot;lga&quot;                    &quot;lga_id&quot;                
##  [3] &quot;state&quot;                  &quot;zone&quot;                  
##  [5] &quot;c_section_yn&quot;           &quot;num_nurses_fulltime&quot;   
##  [7] &quot;gps&quot;                    &quot;num_lab_techs_fulltime&quot;
##  [9] &quot;management&quot;             &quot;num_doctors_fulltime&quot;
</code></pre>

<p>But that just shows us the &ldquo;headers&rdquo; of our dataset, not the values. What happens if you just type sample_data into the console? </p>

<p>Often, seeing the whole dataset is too much. But it is easy to &ldquo;take a peek&rdquo; at your dataset by using <code>head</code> (which UNIX users may have heard of already):</p>

<pre><code class="r">head(sample_data)
</code></pre>

<pre><code>##           lga lga_id   state          zone c_section_yn
## 1 Barkin-Ladi     91 Plateau North-Central        FALSE
## 2     Anaocha     49 Anambra     Southeast        FALSE
## 3     Batsari     96 Katsina     Northwest        FALSE
## 4        Orlu    611     Imo     Southeast        FALSE
## 5        Guma    258   Benue North-Central        FALSE
## 6    Ayamelum     76 Anambra     Southeast        FALSE
##   num_nurses_fulltime                                           gps
## 1                   0   9.57723376 8.98908176 1285.699951171875 5.0
## 2                   2   6.07903635 7.00366347 276.1000061035156 5.0
## 3                   1  12.91273864 7.31050997 472.3999938964844 5.0
## 4                   0 5.768364071846008 7.061988115310669 241.0 4.0
## 5                   0  7.71806025 8.74342196 147.89999389648438 5.0
## 6                   0  6.481826305389404 6.938955187797546 78.0 6.0
##   num_lab_techs_fulltime management num_doctors_fulltime
## 1                      1     public                    0
## 2                     NA     public                   NA
## 3                      1     public                    0
## 4                      0     public                    0
## 5                      0     public                    0
## 6                      1     public                    1
</code></pre>

<p>Questions:</p>

<ul>
<li>How many rows of data did we get out?</li>
<li>Did you count to get your answer? If you did, how could you get your answer from R?</li>
<li>How many columns of data did we get out? How would you check in R?</li>
<li>Could you change the number of rows that head outputs? How would you find out?</li>
<li>Can you create a new data.frame, called <code>small_sample</code>, which is just the first 10 rows of <code>sample_data</code>?</li>
</ul>

<h3>Columns in a data.frame</h3>

<p>A column in our data frame is equivalent to either a column in the survey, or a column that we created as a calculation. </p>

<ol>
<li>using &ldquo;$&rdquo; operator and the column&#39;s name (eg. dataframe$col_name)</li>
<li>using the [,] method, or bracket method (eg. dataframe[,&#39;column_name&#39;])</li>
</ol>

<p>Examples below. Note! We are using small_data, which is just the first ten rows of sample_data</p>

<pre><code class="r">small_data &lt;- head(sample_data, 10)
small_data$lga

small_data[, &quot;lga&quot;]
</code></pre>

<p>We generally prefer the first strategy, but sometimes we&#39;ll need to use the second strategy, particularly when working with mulitple columns. Before we go there, though, lets talk about data types in R. Type</p>

<pre><code class="r">str(sample_data)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    50 obs. of  10 variables:
##  $ lga                   : chr  &quot;Barkin-Ladi&quot; &quot;Anaocha&quot; &quot;Batsari&quot; &quot;Orlu&quot; ...
##  $ lga_id                : int  91 49 96 611 258 76 232 441 101 261 ...
##  $ state                 : chr  &quot;Plateau&quot; &quot;Anambra&quot; &quot;Katsina&quot; &quot;Imo&quot; ...
##  $ zone                  : chr  &quot;North-Central&quot; &quot;Southeast&quot; &quot;Northwest&quot; &quot;Southeast&quot; ...
##  $ c_section_yn          : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
##  $ num_nurses_fulltime   : int  0 2 1 0 0 0 0 1 3 0 ...
##  $ gps                   : chr  &quot;9.57723376 8.98908176 1285.699951171875 5.0&quot; &quot;6.07903635 7.00366347 276.1000061035156 5.0&quot; &quot;12.91273864 7.31050997 472.3999938964844 5.0&quot; &quot;5.768364071846008 7.061988115310669 241.0 4.0&quot; ...
##  $ num_lab_techs_fulltime: int  1 NA 1 0 0 1 0 0 2 0 ...
##  $ management            : chr  &quot;public&quot; &quot;public&quot; &quot;public&quot; &quot;public&quot; ...
##  $ num_doctors_fulltime  : int  0 NA 0 0 0 1 0 1 0 0 ...
</code></pre>

<p>Can anyone guess what this output means?</p>

<h3>Data types in R</h3>

<p>Each value is R has a data type, like most languages. Lets see some obvious values first:</p>

<pre><code class="r">class(1)
</code></pre>

<pre><code>## [1] &quot;numeric&quot;
</code></pre>

<pre><code class="r">class(TRUE)
</code></pre>

<pre><code>## [1] &quot;logical&quot;
</code></pre>

<pre><code class="r">class(&quot;Suya&quot;)
</code></pre>

<pre><code>## [1] &quot;character&quot;
</code></pre>

<p>In R, each column has a single type. Example:</p>

<pre><code class="r">class(sample_data$lga)
</code></pre>

<pre><code>## [1] &quot;character&quot;
</code></pre>

<pre><code class="r">class(sample_data$num_nurses_fulltime)
</code></pre>

<pre><code>## [1] &quot;integer&quot;
</code></pre>

<p>The core types in R are:</p>

<ol>
<li>numerical</li>
<li>integer</li>
<li>boolean</li>
<li>character</li>
<li>factors

<ul>
<li>Generic data type used as alternative to all of the above. We recommend <strong>not</strong> using excecpt in advanced uses. </li>
<li>Specifically, there are typically challenges with factor =&gt; integer/numeric conversions. We&#39;ll talk about this later.</li>
<li>For additional information on working with factors in your data: <a href="http://www.statmethods.net/input/datatypes.html">More information on Factors</a></li>
</ul></li>
</ol>

<p>A note: <code>NA</code> or <strong>Not Available</strong> is a internal value in R, and can be of any type. For example, look at the <code>num_doctors_fulltime</code> column:</p>

<pre><code class="r">small_data$num_doctors_fulltime
</code></pre>

<pre><code>## Error: object &#39;small_data&#39; not found
</code></pre>

<pre><code class="r">class(small_data$num_doctors_fulltime)
</code></pre>

<pre><code>## Error: object &#39;small_data&#39; not found
</code></pre>

<p>This is incredibly helpful for dealing with survey data. In survey data, NA means &#39;missing value&#39;. This can happen for many reasons. For example, an enumerator can simply have skipped the question. Or the question may have been skipped because of skip logic (more on that later).</p>

<h3>Rows of a data frame</h3>

<p>We have looked at data frame columns so far. Lets look at a row in our dataset. A row in our data set is equavilent to one full survey i.e. one facility (though in this case it is a subset of all the data at the facilty).</p>

<p>NOTE: Indexing starts at 1 in R, not 0. There is no 0th item. </p>

<pre><code class="r">small_data[1, ]  # the first row
</code></pre>

<pre><code>## Error: object &#39;small_data&#39; not found
</code></pre>

<pre><code class="r">small_data[5, ]  # the fifth row
</code></pre>

<pre><code>## Error: object &#39;small_data&#39; not found
</code></pre>

<pre><code class="r">small_data[100, ]  # the 100th row, which doesn&#39;t exist
</code></pre>

<pre><code>## Error: object &#39;small_data&#39; not found
</code></pre>

<p>Question: what do you think <code>class(small_data[1,])</code> is?</p>

<h3>More slicing and dicing</h3>

<p>If you remember, we used the [,] operator before. For a <code>data.frame</code>, the [,] operator selects one or more rows or columns. The syntax is <code>data.frame[row, col]</code>, though row and col can be many things.</p>

<p>The simplest example; lets get the 4th row and 5th column:</p>

<pre><code class="r">sample_data[4, 5]
</code></pre>

<pre><code>## [1] FALSE
</code></pre>

<p>In R (like in python), the <code>:</code> operator is an operator for making a list of numbers.</p>

<pre><code class="r">1:5
</code></pre>

<pre><code>## [1] 1 2 3 4 5
</code></pre>

<pre><code class="r">sample_data[4:6, 1:5]
</code></pre>

<pre><code>##        lga lga_id   state          zone c_section_yn
## 4     Orlu    611     Imo     Southeast        FALSE
## 5     Guma    258   Benue North-Central        FALSE
## 6 Ayamelum     76 Anambra     Southeast        FALSE
</code></pre>

<p>Note that the selectors for our [,] operator don&#39;t need to be integers. What do the following do?</p>

<pre><code>sample_data[4:6, &#39;lga&#39;]
sample_data[4:6, c(&#39;lga&#39;, &#39;zone&#39;)]
</code></pre>

<p>We haven&#39;t seen <code>c</code> before. What does <code>c</code> do?</p>

<h3>Summary statistics</h3>

<p>R is also called the &ldquo;the R project for stastical computing. The power of R is in data analysis and statistics, which is why we are working with it. Lets start exploring some of R&#39;s very basic statistic functionalities.</p>

<p>The first set of functions will just give you a simple <code>summary</code> of the values in a certain column. There are two useful functions for this:</p>

<ul>
<li><strong>table()</strong> should be used for character (string) variables</li>
<li><strong>summary()</strong> should be used for numerical or boolean variables</li>
</ul>

<pre><code class="r">table(sample_data$zone)
</code></pre>

<pre><code>## 
## North-Central     Northeast     Northwest   South-South     Southeast 
##             7             5            12             9             8 
##     Southwest 
##             9
</code></pre>

<pre><code class="r">summary(sample_data$num_nurses_fulltime)
</code></pre>

<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
##    0.00    0.00    0.00    1.02    1.00    8.00       3
</code></pre>

<pre><code class="r">summary(sample_data$c_section_yn)
</code></pre>

<pre><code>##    Mode   FALSE    TRUE    NA&#39;s 
## logical      39      10       1
</code></pre>

<p>Note that <code>table</code> can also be used for numeric and categorical variables. </p>

<pre><code class="r">table(sample_data$num_nurses_fulltime)
</code></pre>

<pre><code>## 
##  0  1  2  3  5  6  7  8 
## 30  6  5  2  1  1  1  1
</code></pre>

<pre><code class="r">table(sample_data$c_section_yn)
</code></pre>

<pre><code>## 
## FALSE  TRUE 
##    39    10
</code></pre>

<p>Questions:</p>

<ul>
<li>What is different between table and summary for numerical variables?</li>
<li>What is different between table and summary for boolean (&#39;logical&#39;) variables?</li>
</ul>

<h4>Sums, Mean, Standard Deviation</h4>

<p>Calculating the mean is easy, but it does require some care:</p>

<pre><code class="r">sum(sample_data$num_nurses_fulltime)
</code></pre>

<pre><code>## [1] NA
</code></pre>

<pre><code class="r">sum(sample_data$num_nurses_fulltime, na.rm = TRUE)
</code></pre>

<pre><code>## [1] 48
</code></pre>

<p>There are many numerical functions that return <code>NA</code> unless <code>na.rm</code> is passed as true, if there are any NAs in  your data (and in NMIS data, there always are):</p>

<pre><code class="r">mean(sample_data$num_nurses_fulltime, na.rm = T)
</code></pre>

<pre><code>## [1] 1.021
</code></pre>

<p>What do you think the function for calculating standard deviation is? How would you find out?</p>

<h2>Libraries</h2>

<p>R is a programming languages, so it allows you to write &quot;modules&rdquo; or &ldquo;libraries&rdquo; that can be distributed to others. These are called packages in R. To install packges in R, use <code>install.packages</code> with quoted package name: </p>

<pre><code class="r">install.packages(&quot;plyr&quot;)
</code></pre>

<p>To load the library (similar to <code>import</code> in other languages), you use the <code>library</code> function:</p>

<pre><code class="r">library(plyr)
</code></pre>

<p>R packages (or libraries) contain additional specialized functions for different purposes. <code>plyr</code> is one of our favorites, and contains very useful functions for aggregating data that we will explore soon. Be sure that the package you are trying to load is installed on your computer.</p>

<pre><code class="r">library(eaf)
</code></pre>

<pre><code>## Error: there is no package called &#39;eaf&#39;
</code></pre>

<p>What should you see if you see this error?</p>

<h2>Joing data frames, creating new from old</h2>

<h3>Joining columns:</h3>

<p>R supports SQL-like join functionality with <code>merge</code>. First lets prepare some data to merge:</p>

<pre><code class="r">data1 &lt;- subset(sample_data, select = -c(zone, gps))
head(data1)
</code></pre>

<pre><code>##           lga lga_id   state c_section_yn num_nurses_fulltime
## 1 Barkin-Ladi     91 Plateau        FALSE                   0
## 2     Anaocha     49 Anambra        FALSE                   2
## 3     Batsari     96 Katsina        FALSE                   1
## 4        Orlu    611     Imo        FALSE                   0
## 5        Guma    258   Benue        FALSE                   0
## 6    Ayamelum     76 Anambra        FALSE                   0
##   num_lab_techs_fulltime management num_doctors_fulltime
## 1                      1     public                    0
## 2                     NA     public                   NA
## 3                      1     public                    0
## 4                      0     public                    0
## 5                      0     public                    0
## 6                      1     public                    1
</code></pre>

<pre><code class="r">data2 &lt;- unique(subset(sample_data, select = c(state, zone), subset = zone != 
    &quot;Southeast&quot;))
head(data2)
</code></pre>

<pre><code>##         state          zone
## 1     Plateau North-Central
## 3     Katsina     Northwest
## 5       Benue North-Central
## 7      Bauchi     Northeast
## 8       Lagos     Southwest
## 9 Cross River   South-South
</code></pre>

<p>Inner join:</p>

<pre><code class="r">inner_join &lt;- merge(data1, data2, by = &quot;state&quot;)
</code></pre>

<p>Outer join:</p>

<pre><code class="r">outer_join &lt;- merge(data1, data2, by = &quot;state&quot;, all = TRUE)
</code></pre>

<p>Left outer join:</p>

<pre><code class="r">left_outer_join &lt;- merge(data1, data2, by.x = &quot;lga_id&quot;, by.y = &quot;lga_id&quot;, all.x = TRUE)
</code></pre>

<pre><code>## Error: &#39;by&#39; must specify a uniquely valid column
</code></pre>

<p>We can also concatenate two data.frames together, either column-wise (ie, side-by-side) or row-wise (ie, top-and-bottom). Note that the number of rows have to be same in order to combine side-by-side:</p>

<pre><code class="r">cbind(data1, data2)
</code></pre>

<pre><code>## Error: arguments imply differing number of rows: 50, 21
</code></pre>

<pre><code class="r">cbind(head(data1), head(data2))
</code></pre>

<pre><code>##           lga lga_id   state c_section_yn num_nurses_fulltime
## 1 Barkin-Ladi     91 Plateau        FALSE                   0
## 2     Anaocha     49 Anambra        FALSE                   2
## 3     Batsari     96 Katsina        FALSE                   1
## 4        Orlu    611     Imo        FALSE                   0
## 5        Guma    258   Benue        FALSE                   0
## 6    Ayamelum     76 Anambra        FALSE                   0
##   num_lab_techs_fulltime management num_doctors_fulltime       state
## 1                      1     public                    0     Plateau
## 2                     NA     public                   NA     Katsina
## 3                      1     public                    0       Benue
## 4                      0     public                    0      Bauchi
## 5                      0     public                    0       Lagos
## 6                      1     public                    1 Cross River
##            zone
## 1 North-Central
## 2     Northwest
## 3 North-Central
## 4     Northeast
## 5     Southwest
## 6   South-South
</code></pre>

<p>Can you break down what the last statement did, one by one?</p>

<p>Row-wise concatenation happens with <code>rbind</code>. Again, you need the same rows in both data sets:</p>

<pre><code class="r">data4 &lt;- sample_data[1:5, ]
data5 &lt;- sample_data[6:10, ]
rbind(data4, data5)
</code></pre>

<pre><code>##            lga lga_id       state          zone c_section_yn
## 1  Barkin-Ladi     91     Plateau North-Central        FALSE
## 2      Anaocha     49     Anambra     Southeast        FALSE
## 3      Batsari     96     Katsina     Northwest        FALSE
## 4         Orlu    611         Imo     Southeast        FALSE
## 5         Guma    258       Benue North-Central        FALSE
## 6     Ayamelum     76     Anambra     Southeast        FALSE
## 7       Gamawa    232      Bauchi     Northeast        FALSE
## 8       Kosofe    441       Lagos     Southwest         TRUE
## 9      Bekwara    101 Cross River   South-South        FALSE
## 10      Gurara    261       Niger North-Central        FALSE
##    num_nurses_fulltime                                            gps
## 1                    0    9.57723376 8.98908176 1285.699951171875 5.0
## 2                    2    6.07903635 7.00366347 276.1000061035156 5.0
## 3                    1   12.91273864 7.31050997 472.3999938964844 5.0
## 4                    0  5.768364071846008 7.061988115310669 241.0 4.0
## 5                    0   7.71806025 8.74342196 147.89999389648438 5.0
## 6                    0   6.481826305389404 6.938955187797546 78.0 6.0
## 7                    0  12.27000784 10.52387339 382.6000061035156 5.0
## 8                    1    6.60113991 3.41806628 35.29999923706055 5.0
## 9                    3 6.6513848304748535 8.869051337242126 151.0 4.0
## 10                   0    9.38993463 7.07370386 531.2000122070313 5.0
##    num_lab_techs_fulltime management num_doctors_fulltime
## 1                       1     public                    0
## 2                      NA     public                   NA
## 3                       1     public                    0
## 4                       0     public                    0
## 5                       0     public                    0
## 6                       1     public                    1
## 7                       0     public                    0
## 8                       0       &lt;NA&gt;                    1
## 9                       2     public                    0
## 10                      0     public                    0
</code></pre>

<p>Use this function with care. If your columns don&#39;t align, you&#39;ll have a problem:</p>

<pre><code class="r">rbind(data1, data2)
</code></pre>

<pre><code>## Error: numbers of columns of arguments do not match
</code></pre>

<p>There is a powerful replacement of <code>rbind</code> in the <strong>plyr</strong> package, called <code>rbind.fill</code>. With <code>rbind</code> you have to make every column in both data.frames exist and allign (ie, have the same index number), but with <code>rbind.fill</code> you need not be concerned. <code>rbind.fill</code> finds the corresponding column in data.frame2 and concatenates the data, and if there&#39;s no corresponding part it assigns <strong><em>NA</em></strong>. Do be careful though, you might accidentally concatenate the wrong data frames, and instead of complaining, <code>rbind.fill</code> will just fill your dataset with NAs.</p>

<pre><code class="r">head(rbind.fill(data1, data2))
</code></pre>

<h3>Subset</h3>

<p>Getting a subset of original data with a handy functions saves a lot of typing</p>

<pre><code class="r">subset(sample_data, lga_id &lt; 500, select = c(&quot;lga_id&quot;, &quot;lga&quot;, &quot;state&quot;))
</code></pre>

<pre><code>##    lga_id             lga       state
## 1      91     Barkin-Ladi     Plateau
## 2      49         Anaocha     Anambra
## 3      96         Batsari     Katsina
## 5     258            Guma       Benue
## 6      76        Ayamelum     Anambra
## 7     232          Gamawa      Bauchi
## 8     441          Kosofe       Lagos
## 9     101         Bekwara Cross River
## 10    261          Gurara       Niger
## 11    359        Ise/Orun       Ekiti
## 15    218      Ezinihitte         Imo
## 17    312          Ihiala     Anambra
## 18    152           Daura     Katsina
## 21    488         Maradun     Zamfara
## 22    396    kaduna South      Kaduna
## 24    452          Kusada     Katsina
## 25     43          Aliero       Kebbi
## 27    191        Ekwusigo     Anambra
## 29    161           Donga      Taraba
## 31    324       Ika South       Delta
## 32    183     Ehime-Mbano         Imo
## 33    142          Damban      Bauchi
## 36    466             Lau      Taraba
## 37    473          Madobi        Kano
## 38    349          Ingawa     Katsina
## 39    223         Faskari     Katsina
## 42    487            Mani     Katsina
## 44    316     Ijebu North        Ogun
## 46     67 Atakunmosa West        Osun
## 47     79          Babura      Jigawa
## 49    304        Ifelodun        Osun
</code></pre>

<h2>Data cleaning:</h2>

<h3>Type conversion</h3>

<p>Type conversion can be forced by <code>as.*</code> functions. Common <strong>*</strong> types you&#39;d encounter are: </p>

<ol>
<li>numeric</li>
<li>integer</li>
<li>character</li>
<li>logical
Sometimes you&#39;ll encounter <strong>factor</strong> variables, we recommend using <strong>as.character()</strong> function to convert it into character type before proceeding </li>
</ol>

<pre><code class="r">my_numbers &lt;- c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;TRUE&quot;)
my_numbers
</code></pre>

<pre><code>## [1] &quot;1&quot;    &quot;2&quot;    &quot;3&quot;    &quot;4&quot;    &quot;TRUE&quot;
</code></pre>

<pre><code class="r">as.numeric(my_numbers)
</code></pre>

<pre><code>## Warning: NAs introduced by coercion
</code></pre>

<pre><code>## [1]  1  2  3  4 NA
</code></pre>

<pre><code class="r">as.logical(my_numbers)
</code></pre>

<pre><code>## [1]   NA   NA   NA   NA TRUE
</code></pre>

<h2>Creating and deleting columns</h2>

<p>Creating a column from a vector </p>

<pre><code class="r">sample_data$simple &lt;- 1:50
# a head() of the newly created simple column:
</code></pre>

<pre><code>## [1] 1 2 3 4 5 6
</code></pre>

<ul>
<li>column creation: <strong>broadcasting</strong><br/>

<ul>
<li>R makes column creation very straightforward by repeating a value which is known as &ldquo;broadcasting&rdquo;</li>
</ul></li>
</ul>

<pre><code class="r">sample_data$simple &lt;- &quot;who wants some egusi?&quot;
# a head() of the newly defined simple column:
</code></pre>

<pre><code>## [1] &quot;who wants some egusi?&quot; &quot;who wants some egusi?&quot; &quot;who wants some egusi?&quot;
## [4] &quot;who wants some egusi?&quot; &quot;who wants some egusi?&quot; &quot;who wants some egusi?&quot;
</code></pre>

<ul>
<li>creating a column from a single value

<ul>
<li>R allows the user to broadcast numerical values as well</li>
</ul></li>
</ul>

<pre><code class="r">sample_data$simple &lt;- 1963
# a head() of the newly defined simple column
</code></pre>

<pre><code>## [1] 1963 1963 1963 1963 1963 1963
</code></pre>

<ul>
<li>column creation: using already existing columns</li>
</ul>

<pre><code class="r"># a look at the lga column
head(sample_data$lga_id)
</code></pre>

<pre><code>## [1]  91  49  96 611 258  76
</code></pre>

<pre><code class="r"># creating a new column, by pasting &#39;9ja:&#39; to the values of the lga column
sample_data$lga_id_national &lt;- paste(&quot;9ja:&quot;, sample_data$lga_id, sep = &quot;&quot;)
# a look at the the new lga_id_national column
head(sample_data$lga_id_national)
</code></pre>

<pre><code>## [1] &quot;9ja:91&quot;  &quot;9ja:49&quot;  &quot;9ja:96&quot;  &quot;9ja:611&quot; &quot;9ja:258&quot; &quot;9ja:76&quot;
</code></pre>

<ul>
<li>column creation: boolean columns</li>
</ul>

<pre><code class="r">sample_data$public &lt;- sample_data$management == &quot;public&quot;
head(sample_data[, c(&quot;management&quot;, &quot;public&quot;)])
</code></pre>

<pre><code>##   management public
## 1     public   TRUE
## 2     public   TRUE
## 3     public   TRUE
## 4     public   TRUE
## 5     public   TRUE
## 6     public   TRUE
</code></pre>

<pre><code class="r">
sample_data$public_2_docs &lt;- sample_data$management == &quot;public&quot; &amp; sample_data$num_doctors_fulltime == 
    2
head(sample_data[, c(&quot;public_2_docs&quot;, &quot;management&quot;, &quot;public&quot;)])
</code></pre>

<pre><code>##   public_2_docs management public
## 1         FALSE     public   TRUE
## 2            NA     public   TRUE
## 3         FALSE     public   TRUE
## 4         FALSE     public   TRUE
## 5         FALSE     public   TRUE
## 6         FALSE     public   TRUE
</code></pre>

<ul>
<li>renaming<br/></li>
</ul>

<pre><code class="r"># quote the current variable name, and set it equal the quoted desired name
sample_data &lt;- rename(sample_data, c(gps = &quot;global_positioning_system&quot;))
</code></pre>

<ul>
<li>removing columns</li>
</ul>

<pre><code class="r">sample_data$num_nurselabtechs_fulltime &lt;- NULL
# testing to make sure it no longer exists
summary(sample_data$num_nurselabtechs_fulltime)
</code></pre>

<pre><code>## Length  Class   Mode 
##      0   NULL   NULL
</code></pre>

<h3>Libraries</h3>

<ul>
<li>install packages</li>
<li>to install packges in R, call <strong>install.packages()</strong> with quoted package name: </li>
</ul>

<pre><code class="r">install.packages(&quot;plyr&quot;)
</code></pre>

<ul>
<li>to load libraries in R call <strong>library()</strong> fucntion</li>
</ul>

<pre><code class="r">library(plyr)
</code></pre>

<ul>
<li>libraries are additional packages to R that contain additional specialized functions </li>
<li><p>plyr library is used for aggregating data, which will be explored in detail later</p>

<ul>
<li>be sure that the package you are trying to load is installed on your computer</li>
</ul></li>
</ul>

<pre><code class="r">library(eaf)
</code></pre>

<pre><code>## Error: there is no package called &#39;eaf&#39;
</code></pre>

<h2>data cleaning</h2>

<h3>string manipulations</h3>

<ul>
<li>we&#39;re going to cover regex suite comes with base R, string_r packages have similar implementations.</li>
<li>we&#39;re not going to cover regex/ regular expression in this tuorial.</li>
<li>getting position of matched pattern with grep()</li>
</ul>

<pre><code class="r">my_strings = c(&quot;Hello&quot;, &quot;World&quot;, &quot;Foo&quot;)
grep(pattern = &quot;l&quot;, x = my_strings, ignore.case = FALSE)
</code></pre>

<pre><code>## [1] 1 2
</code></pre>

<pre><code class="r"># when value argument is set to true, grep() returns the actual strings
# matchs the patterns
grep(pattern = &quot;l&quot;, x = my_strings, ignore.case = FALSE, value = T)
</code></pre>

<pre><code>## [1] &quot;Hello&quot; &quot;World&quot;
</code></pre>

<ul>
<li>find pattern in strings and replace with sub()</li>
<li>gsub() means global sub, which replace all the occurance of matching pattern, while sub() only works on the first appearance.</li>
</ul>

<pre><code class="r">my_strings
</code></pre>

<pre><code>## [1] &quot;Hello&quot; &quot;World&quot; &quot;Foo&quot;
</code></pre>

<pre><code class="r">sub(pattern = &quot;o&quot;, replacement = &quot;X&quot;, x = my_strings)
</code></pre>

<pre><code>## [1] &quot;HellX&quot; &quot;WXrld&quot; &quot;FXo&quot;
</code></pre>

<pre><code class="r">gsub(pattern = &quot;o&quot;, replacement = &quot;X&quot;, x = my_strings)
</code></pre>

<pre><code>## [1] &quot;HellX&quot; &quot;WXrld&quot; &quot;FXX&quot;
</code></pre>

<ul>
<li>change to upper/lower case with toupper()/ tolower()</li>
</ul>

<pre><code class="r">my_strings
</code></pre>

<pre><code>## [1] &quot;Hello&quot; &quot;World&quot; &quot;Foo&quot;
</code></pre>

<pre><code class="r">toupper(my_strings)
</code></pre>

<pre><code>## [1] &quot;HELLO&quot; &quot;WORLD&quot; &quot;FOO&quot;
</code></pre>

<pre><code class="r">tolower(my_strings)
</code></pre>

<pre><code>## [1] &quot;hello&quot; &quot;world&quot; &quot;foo&quot;
</code></pre>

<ul>
<li>concatenate strings with paste():</li>
</ul>

<pre><code class="r">paste(&quot;hello&quot;, &quot;world&quot;, &quot;foo&quot;, sep = &quot;,&quot;)
</code></pre>

<pre><code>## [1] &quot;hello,world,foo&quot;
</code></pre>

<ul>
<li>if you&#39;re trying to concate every element in a vector/ list, use <strong>collapse</strong> argument in paste()</li>
</ul>

<pre><code class="r">paste(my_strings, sep = &quot;,&quot;)
</code></pre>

<pre><code>## [1] &quot;Hello&quot; &quot;World&quot; &quot;Foo&quot;
</code></pre>

<pre><code class="r">paste(my_strings, collapse = &quot;,&quot;)
</code></pre>

<pre><code>## [1] &quot;Hello,World,Foo&quot;
</code></pre>

<h3>writing out data</h3>

<ul>
<li>R can output multiple different output format, but we&#39;re going to cover csv and RDS format</li>
<li>writing csv file with write.csv()

<ul>
<li>if you find output row.names everytime annoying, set row.names argument to FALSE in write.csv()</li>
</ul></li>
</ul>

<pre><code class="r">write.csv(sample_data, &quot;./my_output.csv&quot;, row.names = FALSE)
</code></pre>

<ul>
<li>we recommend output your data as RDS file, if you&#39;re only going to reuse it in R.</li>
<li>use saveRDS() to save object in workspace to your harddrive

<ul>
<li>no row.names argument needs to be used, since we&#39;re saving the R object into a binary file</li>
</ul></li>
</ul>

<pre><code class="r">saveRDS(sample_data, &quot;./my_output.RDS&quot;)
</code></pre>

<ul>
<li>use readRDS() function to load saved RDS file</li>
</ul>

<pre><code class="r">readRDS(&quot;./my_output.RDS&quot;)
</code></pre>

<pre><code>##            lga lga_id       state          zone c_section_yn
## 1  Barkin-Ladi     91     Plateau North-Central        FALSE
## 2      Anaocha     49     Anambra     Southeast        FALSE
## 3      Batsari     96     Katsina     Northwest        FALSE
## 4         Orlu    611         Imo     Southeast        FALSE
## 5         Guma    258       Benue North-Central        FALSE
## 6     Ayamelum     76     Anambra     Southeast        FALSE
## 7       Gamawa    232      Bauchi     Northeast        FALSE
## 8       Kosofe    441       Lagos     Southwest         TRUE
## 9      Bekwara    101 Cross River   South-South        FALSE
## 10      Gurara    261       Niger North-Central        FALSE
##    num_nurses_fulltime                      global_positioning_system
## 1                    0    9.57723376 8.98908176 1285.699951171875 5.0
## 2                    2    6.07903635 7.00366347 276.1000061035156 5.0
## 3                    1   12.91273864 7.31050997 472.3999938964844 5.0
## 4                    0  5.768364071846008 7.061988115310669 241.0 4.0
## 5                    0   7.71806025 8.74342196 147.89999389648438 5.0
## 6                    0   6.481826305389404 6.938955187797546 78.0 6.0
## 7                    0  12.27000784 10.52387339 382.6000061035156 5.0
## 8                    1    6.60113991 3.41806628 35.29999923706055 5.0
## 9                    3 6.6513848304748535 8.869051337242126 151.0 4.0
## 10                   0    9.38993463 7.07370386 531.2000122070313 5.0
##    num_lab_techs_fulltime management num_doctors_fulltime
## 1                       1     public                    0
## 2                      NA     public                   NA
## 3                       1     public                    0
## 4                       0     public                    0
## 5                       0     public                    0
## 6                       1     public                    1
## 7                       0     public                    0
## 8                       0       &lt;NA&gt;                    1
## 9                       2     public                    0
## 10                      0     public                    0
</code></pre>

<h2>Aggregations in R:</h2>

<ul>
<li><p>there are many functions that can do aggregation for you, but we are only going to cover <strong>ddply()</strong> in <strong>plyr</strong> package</p></li>
<li><p>creating simple aggregated summary:</p></li>
<li><p>note: </p>

<ol>
<li><strong>(group) by</strong> variable must have at least one input</li>
<li>you <strong>must</strong> specify what type of aggregation you want to perform, choose one from: summarize, transform</li>
</ol></li>
<li><p><a href="http://cran.r-project.org/web/packages/plyr/plyr.pdf">the link to the package dodument</a></p></li>
</ul>

<pre><code class="r">library(plyr)
my_summary &lt;- ddply(sample_data, .(state, lga), summarise, counts = length(lga_id), 
    total_num_nurse = sum(num_nurses_fulltime, na.rm = T), avg_c_section = mean(c_section_yn == 
        T, na.rm = T))
head(my_summary)
</code></pre>

<pre><code>##     state           lga counts total_num_nurse avg_c_section
## 1    Abia Umuahia North      1               0             1
## 2 Adamawa      Shelleng      1               2             0
## 3 Anambra       Anaocha      1               2             0
## 4 Anambra      Ayamelum      1               0             0
## 5 Anambra      Ekwusigo      1               0             1
## 6 Anambra        Ihiala      1               2             1
</code></pre>

<ul>
<li>look at the output and compare the difference, the only change here is replacing summarize with transform</li>
</ul>

<pre><code class="r">my_summary &lt;- ddply(sample_data, .(state, lga), transform, counts = length(lga_id), 
    total_num_nurse = sum(num_nurses_fulltime, na.rm = T), avg_c_section = mean(c_section_yn == 
        T, na.rm = T))
head(my_summary)
</code></pre>

<pre><code>##             lga lga_id   state      zone c_section_yn num_nurses_fulltime
## 1 Umuahia North    728    Abia Southeast         TRUE                  NA
## 2      Shelleng    676 Adamawa Northeast        FALSE                   2
## 3       Anaocha     49 Anambra Southeast        FALSE                   2
## 4      Ayamelum     76 Anambra Southeast        FALSE                   0
## 5      Ekwusigo    191 Anambra Southeast         TRUE                   0
## 6        Ihiala    312 Anambra Southeast         TRUE                   2
##                        global_positioning_system num_lab_techs_fulltime
## 1     5.5224549 7.49361609 175.1999969482422 5.0                     41
## 2 9.884562492370605 12.023136019706726 219.0 4.0                     NA
## 3    6.07903635 7.00366347 276.1000061035156 5.0                     NA
## 4   6.481826305389404 6.938955187797546 78.0 6.0                      1
## 5                5.95802932 6.84972263 148.0 5.0                      0
## 6   5.88475837 6.89508114 110.30000305175781 5.0                      0
##   management num_doctors_fulltime simple lga_id_national public
## 1     public                  308   1963         9ja:728   TRUE
## 2     public                    1   1963         9ja:676   TRUE
## 3     public                   NA   1963          9ja:49   TRUE
## 4     public                    1   1963          9ja:76   TRUE
## 5       &lt;NA&gt;                    1   1963         9ja:191     NA
## 6       &lt;NA&gt;                    1   1963         9ja:312     NA
##   public_2_docs counts total_num_nurse avg_c_section
## 1         FALSE      1               0             1
## 2         FALSE      1               2             0
## 3            NA      1               2             0
## 4         FALSE      1               0             0
## 5         FALSE      1               0             1
## 6         FALSE      1               2             1
</code></pre>

<h1>Advanced R</h1>

<h2>creation of more complex columns(indicators) with <strong>rowSums()</strong>:</h2>

<ul>
<li>column creation: sum of multiple numerical columns </li>
</ul>

<pre><code class="r">sample_data$num_nurselabtechs_fulltime &lt;- rowSums(cbind(sample_data$num_nurses_fulltime, 
    sample_data$num_lab_techs_fulltime, na.rm = T))
</code></pre>

<pre><code class="r"># now we can view all three variables: the new num_nurselabtechs_fulltime
# variable, and the two used to create it
head(subset(sample_data, select = c(&quot;num_nurses_fulltime&quot;, &quot;num_lab_techs_fulltime&quot;, 
    &quot;num_nurselabtechs_fulltime&quot;)), 5)
</code></pre>

<pre><code>##   num_nurses_fulltime num_lab_techs_fulltime num_nurselabtechs_fulltime
## 1                   0                      1                          2
## 2                   2                     NA                         NA
## 3                   1                      1                          3
## 4                   0                      0                          1
## 5                   0                      0                          1
</code></pre>

<h2>creation of more complex columns(indicators) with <strong>ifelse()</strong>:</h2>

<h2>install packages from outside of cran</h2>

<ul>
<li>in order to install packages on github we need some extra work</li>
<li>this tutorial will use the example of formhub.R</li>
<li>first step: install and load <strong>devtools</strong> package from cran</li>
</ul>

<pre><code>install.packages(&#39;devtools&#39;) 
library(devtools)
</code></pre>

<ul>
<li>second step: use <strong>install_github(&ldquo;repo_name&rdquo;, &ldquo;user_name&rdquo;)</strong> function to install packages on github</li>
</ul>

<pre><code>install_github(&quot;formhub.R&quot;, username=&quot;SEL-Columbia&quot;)
library(formhub)
</code></pre>

<h2>map functions: apply()</h2>

<ul>
<li>instead of using for loops, we encourage using map. The apply/sapply is the implementation of map in R</li>
<li>Here&#39;s the simply example for using apply to loop through every column and see the class of the column

<ul>
<li>note: <strong>MARGIN = 2</strong> specifies doing column-wise process</li>
</ul></li>
</ul>

<pre><code class="r">apply(sample_data, MARGIN = 2, FUN = class)
</code></pre>

<pre><code>##                       lga                    lga_id 
##               &quot;character&quot;               &quot;character&quot; 
##                     state                      zone 
##               &quot;character&quot;               &quot;character&quot; 
##              c_section_yn       num_nurses_fulltime 
##               &quot;character&quot;               &quot;character&quot; 
## global_positioning_system    num_lab_techs_fulltime 
##               &quot;character&quot;               &quot;character&quot; 
##                management      num_doctors_fulltime 
##               &quot;character&quot;               &quot;character&quot;
</code></pre>

<ul>
<li>you can also define your own function in apply()</li>
<li>the following code returns sum of <strong>NAs</strong> in each row

<ul>
<li>note: when you&#39;re define your own function in apply use semi-colon as the line marker.</li>
<li>note: <strong>MARGIN = 1</strong> specifies doing row-wise process</li>
</ul></li>
</ul>

<pre><code class="r">apply(sample_data, MARGIN = 1, function(x) {
    na_idx &lt;- is.na(x)
    length(which(na_idx))
})
</code></pre>

<pre><code>##  [1] 0 4 0 0 0 0 0 2 0 0
</code></pre>

<h2>improvements:</h2>

<ul>
<li>load your own functions into workspace with source()</li>
</ul>

<pre><code class="r">source(&quot;./my_source_functions.R&quot;)
my_sum(1, 2)
</code></pre>

<pre><code>## [1] 3
</code></pre>

<ul>
<li>optimize ddply with idata.frame()

<ul>
<li>idata.frame optimizes the computation speed but at the cost of a slight more complicated code</li>
</ul></li>
</ul>

</body>

</html>
